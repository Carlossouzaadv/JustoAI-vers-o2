# ================================================================
# JustoAI V2 - Workers Environment Variables
# ================================================================
# Configuration for the separate workers service on Railway
#
# IMPORTANT: Copy this to Railway service "justoai-workers" as env vars
# DO NOT commit .env.workers with real values!
# ================================================================

# ================================================================
# REDIS CONNECTION (REQUIRED)
# ================================================================
# Upstash Redis URL (from Upstash Console)
# Format: rediss://default:password@host:6379
REDIS_URL=rediss://default:AVt9AAIncDI5Y2Q5YjE2NmZlOWE0N2MzYTM3ZWMyYzgyMGJiNDczNXAyMjM0MjE@accepted-cobra-23421.upstash.io:6379

# Alternative: Individual Redis credentials (if not using REDIS_URL)
# REDIS_HOST=accepted-cobra-23421.upstash.io
# REDIS_PORT=6379
# REDIS_PASSWORD=AVt9AAIncDI5Y2Q5YjE2NmZlOWE0N2MzYTM3ZWMyYzgyMGJiNDczNXAyMjM0MjE
# REDIS_USERNAME=default

# CRITICAL: Set to false or remove - workers NEED Redis
REDIS_DISABLED=false

# ================================================================
# DATABASE CONNECTION (REQUIRED)
# ================================================================
# Supabase PostgreSQL connections
# Workers need database access to update process data

# Connection pooling URL (recommended for workers)
DATABASE_URL=postgresql://postgres.overbsbivbuevmyltyet:YOUR_PASSWORD@aws-0-sa-east-1.pooler.supabase.com:6543/postgres?pgbouncer=true

# Direct connection URL (for Prisma migrations if needed)
DIRECT_URL=postgresql://postgres.overbsbivbuevmyltyet:YOUR_PASSWORD@aws-0-sa-east-1.pooler.supabase.com:5432/postgres

# ================================================================
# WORKER CONFIGURATION (OPTIONAL - Has Defaults)
# ================================================================

# Worker concurrency (how many jobs to process simultaneously)
# Lower = less CPU usage, higher = faster processing
# Default: 2
WORKER_CONCURRENCY=2

# Node environment
NODE_ENV=production

# ================================================================
# JUDIT API CONFIGURATION (REQUIRED for JUDIT workers)
# ================================================================
# JUDIT API credentials for process searching
JUDIT_API_KEY=your_judit_api_key_here
JUDIT_API_BASE_URL=https://api.judit.com.br/v1

# ================================================================
# EXTERNAL APIs (If workers need them)
# ================================================================

# Google Gemini API (for AI analysis in workers)
GOOGLE_API_KEY=your_google_api_key_here

# Email service (if workers send emails)
SMTP_HOST=smtp.resend.com
SMTP_PORT=587
SMTP_USER=resend
SMTP_PASSWORD=your_resend_api_key_here
FROM_EMAIL=noreply@justoai.com

# ================================================================
# OBSERVABILITY (OPTIONAL)
# ================================================================

# Logging level (debug, info, warn, error)
LOG_LEVEL=info

# Enable structured logging (JSON format)
ENABLE_JSON_LOGS=true

# Sentry DSN (error tracking)
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# ================================================================
# COST OPTIMIZATION NOTES
# ================================================================
#
# Idle Cost: $2-5/month
# - Worker process runs but consumes near-zero CPU when no jobs
# - Upstash Redis: $0.20/day base + $0.20 per 100k requests
# - Railway: Minimal CPU/memory when idle
#
# Active Cost: $10-20/month (moderate usage)
# - 100 jobs/day: ~$15/month total
# - 1000 jobs/day: ~$30/month total
#
# Cost Control Tips:
# 1. Lower WORKER_CONCURRENCY (reduces CPU spikes)
# 2. Use job scheduling (process at off-peak hours)
# 3. Monitor Upstash usage dashboard
# 4. Set rate limits on queues
#
# ================================================================
